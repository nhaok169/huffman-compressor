哈夫曼压缩工具 - 用户手册

📖 项目简介

一个基于哈夫曼编码的文本文件压缩/解压工具，支持在压缩文件中直接进行关键字查找，无需完全解压。支持标准ASCII字符（0-127）的文本文件处理。



🚀 功能特性

核心功能

✅ 文件压缩：将文本文件压缩为二进制格式



✅ 文件解压：恢复压缩文件为原始文本



✅ 直接查找：在压缩文件中搜索字符串，无需解压



✅ 压缩率分析：显示压缩前后的文件大小对比



技术亮点

🎯 优化的哈夫曼编码算法



🔍 基于比特流的字符串匹配（Sunday算法变种）



📊 实时字符位置统计



🛡️ 健壮的错误处理和格式验证



📦 文件结构

text

.

├── common.h              # 通用声明和函数原型

├── decoder.cpp/.h        # 解压模块

├── encoder.cpp/.h        # 压缩模块

├── finder.cpp/.h         # 查找模块

├── main.cpp              # 主程序和命令行接口

├── huffman.exe          # Windows可执行文件（编译后）

├── Makefile.win         # Windows编译配置

└── test\_files/          # 测试文件（可选）

&nbsp;   ├── hello.txt        # 示例文本文件

&nbsp;   ├── pg.txt           # 示例文本文件

&nbsp;   └── output.bin       # 示例压缩文件

🔧 编译与运行

Windows环境

bash

\# 方法1：使用预编译的exe

./huffman.exe -e input.txt output.bin



\# 方法2：重新编译（需要Dev-C++或MinGW）

g++ -o huffman main.cpp encoder.cpp decoder.cpp finder.cpp

Linux/Mac环境

bash

\# 编译

g++ -o huffman main.cpp encoder.cpp decoder.cpp finder.cpp -std=c++11



\# 运行

./huffman -e input.txt output.bin

📋 使用说明

基本语法

bash

huffman \[模式] \[输入文件] \[输出文件/搜索词]

模式说明

1\. 压缩模式 (-e)

bash

\# 将文本文件压缩为二进制格式

huffman -e 原始文件.txt 压缩文件.bin



\# 示例

huffman -e hello.txt output.bin

输出示例：



text

哈夫曼编码压缩程序

本程序仅支持标准ASCII文本文件（0-127）

UTF-8或其他编码的文件可能无法正确处理

...

总共需要编码 26 个字符

字符 ' '(ASCII 0x20): 编码长度=3位: 110 (0x6)

字符 'a'(ASCII 0x61): 编码长度=4位: 1110 (0xe)

...

压缩率: 45.23%

2\. 解压模式 (-d)

bash

\# 将压缩文件解压为文本文件

huffman -d 压缩文件.bin 解压文件.txt



\# 示例

huffman -d output.bin restored.txt

输出示例：



text

哈夫曼解码程序

本程序仅支持解码出标准ASCII文本文件（0-127）

...

需要解码共1567个26种字符,编码表:

&nbsp;(ASCII=0x20): 110

a(ASCII=0x61): 1110

...

解码已完成

3\. 查找模式 (-f)

bash

\# 在压缩文件中直接搜索字符串

huffman -f 压缩文件.bin "搜索词"



\# 示例

huffman -f output.bin "hello"

输出示例：



text

编码查找程序

本程序仅支持对HUFF压缩的文件进行查找

...

需要查找共1567个26种字符,编码表:

&nbsp;(ASCII=0x20): 110

a(ASCII=0x61): 1110

...

第1次出现在第1个字符

第2次出现在第34个字符

查找结束，共找到2个

📁 压缩文件格式

二进制格式规范

text

偏移量  大小      内容             说明

0       4字节     "HUFF"          魔数，标识文件格式

4       4字节     原始文件大小     小端字节序，最大支持4GB

8       1字节     字符种类数 N     0-255种字符

9       变长      编码表           N个条目，每个包含：

&nbsp;                                 \[1字节] 字符ASCII码

&nbsp;                                 \[1字节] 编码长度(bits)

&nbsp;                                 \[X字节] 编码数据，X=ceil(len/8)

...     变长      压缩数据         哈夫曼编码的比特流，可能有末尾填充

编码表示例

假设字符'A'的编码为101（3位），则存储为：



字符：0x41 ('A'的ASCII)



长度：0x03 (3位)



编码数据：0xA0 (二进制10100000，高位对齐)



⚠️ 使用限制与注意事项

字符范围限制

仅支持标准ASCII字符（0-127）



UTF-8、中文等扩展字符会被跳过或导致错误



控制字符（0-31）可以处理但显示可能异常



文件大小限制

最大原始文件：4GB（32位无符号整数限制）



最大压缩文件：理论无限制，受内存影响



性能特性

压缩速度：中等，与文件大小成正比



查找速度：使用滑动窗口（100000字节缓存），大文件需多轮处理



内存使用：查找功能需要约100KB窗口内存



🔍 常见问题解答

Q1: 为什么压缩小文件时压缩率可能是负数？

A: 由于编码表需要额外存储，当原始文件很小时，编码表开销可能超过压缩收益。建议对大于1KB的文件使用压缩功能。



Q2: 如何确认压缩文件的完整性？

A: 压缩文件前4字节应为"HUFF"（十六进制48 55 46 46），可以使用hex编辑器验证。



Q3: 查找功能为什么有时会找到错误的位置？

A: 由于哈夫曼编码是变长的，短字符串的编码可能在比特流中偶然匹配。建议：



使用较长的搜索词（≥3字符）



验证找到的上下文是否合理



程序已包含边界检查，但仍存在理论上的伪匹配可能



Q4: 支持批量处理吗？

A: 当前版本为命令行单文件处理，可通过编写批处理脚本实现批量操作。



🛠️ 故障排除

错误信息	可能原因	解决方案

"无法打开输入文件"	文件不存在或权限不足	检查文件路径和权限

"非HUFF压缩格式"	文件格式错误或损坏	确认是否为有效的.huff文件

"字符超出0-127范围"	文件包含非ASCII字符	使用纯ASCII文本文件

"输入文件为空"	文件内容为空	检查文件是否包含有效内容

内存分配失败	文件过大或内存不足	减少文件大小或增加系统内存

📈 性能优化建议

对于大文件（>10MB）

考虑分块压缩（当前版本不支持，需修改）



调整查找窗口大小（修改finder.h中的MAXR定义）



对于频繁查找

建立索引文件（扩展功能）



使用更长的搜索词提高准确性



📚 扩展开发

计划功能

UTF-8编码支持



目录批量处理



进度显示条



多线程压缩/解压



配置文件支持



开发建议

修改字符范围：在encoder.cpp中调整字符检查逻辑



优化内存：调整finder.cpp中的MAXR值



添加新功能：遵循现有模块化设计模式



📄 许可证

本项目为课程设计作品，仅供学习和研究使用。



👥 贡献与反馈

如有问题或建议，请检查：



是否使用纯ASCII文本文件



文件大小是否在限制范围内



命令行参数是否正确



欢迎提供测试用例和改进建议！



最后更新: 2024年1月

版本: 1.0

适用平台: Windows/Linux/Mac (需要C++编译器)



💡 提示: 首次使用建议从hello.txt和pg.txt等小文件开始测试，熟悉操作后再处理大文件。

